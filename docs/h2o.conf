/**
 * SPDX-FileComment: H2O Configuration
 * SPDX-FileType: SOURCE
 * SPDX-FileContributor: ZHENG Robert
 * SPDX-FileCopyrightText: 2026 ZHENG Robert
 * SPDX-License-Identifier: Apache-2.0
 *
 * @file h2o.conf
 */

# H2O Configuration for Photo Gallery
user: h2o
hosts:
  "gallery.local":
    listen:
      port: 443
      ssl:
        certificate-file: /etc/h2o/certs/server.crt
        key-file: /etc/h2o/certs/server.key
    paths:
      "/":
        file.dir: /var/www/gallery/frontend
        file.index: [ 'index.html' ]
        # Fallback for Angular SPA
        error-doc:
          - status: 404
            url: /index.html
      "/photos":
        file.dir: /var/lib/gallery/photos
        header.add: "Cache-Control: public, max-age=86400"
      "/thumbs":
        file.dir: /var/lib/gallery/thumbs
        header.add: "Cache-Control: public, max-age=86400"
      "/api":
        proxy.reverse.url: http://127.0.0.1:8848/api
        proxy.preserve-host: ON

  "gallery.local:80":
    listen:
      port: 80
    paths:
      "/":
        redirect:
          status: 301
          url: https://gallery.local/

compress: [ gzip, br ]
access-log: /var/log/h2o/access.log
error-log: /var/log/h2o/error.log
